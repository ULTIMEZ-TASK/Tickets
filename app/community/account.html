<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Post Scheduler</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Modal Transitions */
        .modal-overlay { transition: opacity 0.2s ease-in-out; }
        .modal-content { transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out; }
        .hidden-modal { opacity: 0; pointer-events: none; }
        .hidden-modal .modal-content { transform: scale(0.95); opacity: 0; }
        .visible-modal { opacity: 1; pointer-events: auto; }
        .visible-modal .modal-content { transform: scale(1); opacity: 1; }

        /* Tooltip */
        .tooltip-trigger:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 4px 8px;
            background: #1f2937;
            color: white;
            font-size: 10px;
            border-radius: 4px;
            white-space: nowrap;
            margin-bottom: 6px;
            z-index: 10;
        }

        /* Calendar Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 h-screen overflow-hidden flex">

    <!-- Mobile Sidebar Overlay -->
    <div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-20 hidden lg:hidden" onclick="toggleSidebar()"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed lg:static inset-y-0 left-0 z-30 w-64 bg-white border-r border-gray-200 transform -translate-x-full lg:translate-x-0 transition-transform duration-200 ease-in-out flex flex-col">
        <!-- Logo -->
        <div class="h-16 flex items-center px-6 border-b border-gray-100">
            <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white mr-3">
                <i data-lucide="hash" class="w-5 h-5"></i>
            </div>
            <span class="text-lg font-bold text-gray-800">CommPost</span>
        </div>

        <!-- Nav Links -->
        <nav class="flex-1 p-4 space-y-1">
            <button onclick="switchTab('accounts')" id="nav-accounts" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors bg-indigo-50 text-indigo-700">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                Community Accounts
            </button>
            <button onclick="switchTab('schedule')" id="nav-schedule" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                <i data-lucide="calendar-days" class="w-5 h-5"></i>
                Scheduled Posts
                <span id="scheduled-count" class="ml-auto bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs">0</span>
            </button>
        </nav>

        <!-- User Profile -->
        <div class="p-4 border-t border-gray-100">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-purple-500 to-indigo-500"></div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-gray-900 truncate">Alex Community Mgr</p>
                    <p class="text-xs text-gray-500 truncate">alex@tech.co</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        <!-- Mobile Header -->
        <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-4 lg:hidden shrink-0">
            <div class="flex items-center gap-3">
                <button onclick="toggleSidebar()" class="p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                    <i data-lucide="menu" class="w-5 h-5"></i>
                </button>
                <span id="mobile-title" class="font-semibold text-gray-900">Accounts</span>
            </div>
        </header>

        <!-- Dynamic Content Container -->
        <div id="content-area" class="flex-1 overflow-auto p-4 sm:p-6 lg:p-8">
            <!-- Content injected by JS -->
        </div>
    </main>

    <!-- Connect Account Modal -->
    <div id="connect-modal" class="hidden-modal fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-overlay absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeModal('connect-modal')"></div>
        <div class="modal-content relative bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden m-4">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="font-semibold text-lg">Connect Account</h3>
                <button onclick="closeModal('connect-modal')" class="p-1 hover:bg-gray-100 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-500"></i>
                </button>
            </div>
            <div class="p-4 space-y-4">
                <p class="text-sm text-gray-500">Select a platform to connect to your community dashboard.</p>
                <div class="grid grid-cols-2 gap-3" id="platform-grid">
                    <!-- Platforms injected by JS -->
                </div>
                <div class="pt-2 flex justify-end gap-2">
                    <button onclick="closeModal('connect-modal')" class="px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Details Modal -->
    <div id="details-modal" class="hidden-modal fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-overlay absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeModal('details-modal')"></div>
        <div class="modal-content relative bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden m-4 max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b shrink-0">
                <h3 class="font-semibold text-lg">Account Details</h3>
                <button onclick="closeModal('details-modal')" class="p-1 hover:bg-gray-100 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-500"></i>
                </button>
            </div>
            <div id="details-content" class="overflow-y-auto">
                <!-- Details injected by JS -->
            </div>
        </div>
    </div>

    <!-- Post/Cluster Details Modal -->
    <div id="post-details-modal" class="hidden-modal fixed inset-0 z-50 flex items-center justify-center">
        <div class="modal-overlay absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeModal('post-details-modal')"></div>
        <div class="modal-content relative bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden m-4 max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b shrink-0 bg-gray-50">
                <h3 class="font-semibold text-lg" id="post-modal-title">Post Details</h3>
                <button onclick="closeModal('post-details-modal')" class="p-1 hover:bg-gray-200 rounded-full transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-500"></i>
                </button>
            </div>
            <div id="post-details-content" class="overflow-y-auto p-6 space-y-6">
                <!-- Content injected by JS -->
            </div>
            <div class="p-4 bg-gray-50 flex justify-end items-center border-t border-gray-200 gap-2">
                <button class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors">Edit Content</button>
                <button onclick="closeModal('post-details-modal')" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-sm">Close</button>
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- Data ---
        const accounts = [
            { id: 1, name: 'Company Twitter', platform: 'Twitter', type: 'Social Media', handle: '@tech_company', icon: 'twitter', color: 'bg-blue-500', followers: '12.5k', growth: '+2.4%', status: 'connected', avgLikes: '142', avgComments: '28', apiGuide: 'https://developer.twitter.com/en/docs' },
            { id: 2, name: 'Tech Blog', platform: 'WordPress', type: 'Blogging', handle: 'techcompany.blog', icon: 'globe', color: 'bg-blue-700', followers: '45k', growth: '+12%', status: 'connected', avgLikes: '1.2k', avgComments: '45', apiGuide: 'https://developer.wordpress.org/rest-api/' },
            { id: 3, name: 'Weekly Digest', platform: 'Substack', type: 'Newsletters', handle: 'digest.substack.com', icon: 'mail', color: 'bg-orange-500', followers: '8.2k', growth: '+5.1%', status: 'warning', avgLikes: 'N/A', avgComments: '12', apiGuide: 'https://substackapi.com/' },
            { id: 4, name: 'Dev Community', platform: 'Reddit', type: 'Forums', handle: 'r/tech_company', icon: 'message-square', color: 'bg-orange-600', followers: '15k', growth: '-0.5%', status: 'connected', avgLikes: '85', avgComments: '150', apiGuide: 'https://www.reddit.com/dev/api/' },
            { id: 5, name: 'LinkedIn Page', platform: 'LinkedIn', type: 'Social Media', handle: '/company/tech', icon: 'linkedin', color: 'bg-blue-800', followers: '50k', growth: '+1.2%', status: 'error', avgLikes: '320', avgComments: '14', apiGuide: 'https://learn.microsoft.com/en-us/linkedin/' },
            { id: 6, name: 'Customer Forum', platform: 'Discourse', type: 'Forums', handle: 'forum.tech.co', icon: 'message-square', color: 'bg-slate-600', followers: '3.4k', growth: '+8.5%', status: 'connected', avgLikes: '45', avgComments: '8', apiGuide: 'https://docs.discourse.org/' },
        ];

        // Added clusterId and topic for grouping demo
        const posts = [
            // Cluster: Q1 Roadmap
            { id: 101, clusterId: 1, topic: 'Q1 Roadmap Launch', title: 'Q1 Product Roadmap Reveal', platformId: 2, content: 'Excited to share what we have been building. Our Q1 roadmap includes 5 major features requested by the community...', date: '2023-10-25T10:00:00', status: 'Scheduled', type: 'Article' },
            { id: 106, clusterId: 1, topic: 'Q1 Roadmap Launch', title: 'Roadmap Thread Breakdown', platformId: 1, content: '1/5 Here is what is coming in Q1. We are focusing on speed and stability. ðŸ§µðŸ‘‡', date: '2023-10-25T10:05:00', status: 'Scheduled', type: 'Thread' },
            
            // Single Posts
            { id: 102, title: 'Server Maintenance Notice', platformId: 1, content: 'Heads up! Scheduled maintenance tonight at 2AM UTC. Expected downtime is approx 15 mins.', date: '2023-10-24T14:30:00', status: 'Published', type: 'Post' },
            { id: 104, title: 'AMA Session Announcement', platformId: 4, content: 'Join us for an AMA with the CEO this Friday! Drop your questions in the thread below.', date: '2023-10-26T16:00:00', status: 'Scheduled', type: 'Thread' },
            { id: 105, title: 'New Feature Teaser', platformId: 5, content: 'Something big is coming... #innovation #tech', date: '2023-10-27T11:00:00', status: 'Scheduled', type: 'Post' },
            
            // Drafts
            { id: 103, title: 'October Newsletter', platformId: 3, content: 'This month: AI trends and new features. Don\'t miss out on the latest updates from our dev team.', date: '2023-10-28T09:00:00', status: 'Draft', type: 'Email' },
            { id: 107, title: 'Holiday Promo Ideas', platformId: 1, content: 'Thinking about a discount code for the holidays... maybe 20% off?', date: '2023-11-01T09:00:00', status: 'Draft', type: 'Post' }
        ];

        const platformTypes = ['All', 'Social Media', 'Blogging', 'Newsletters', 'Forums'];

        // --- State ---
        let activeTab = 'accounts';
        let activeScheduleTab = 'Queue'; // Queue, Drafts, History
        let scheduleView = 'list'; // 'list' or 'calendar'
        let filters = { search: '', platform: 'All', status: 'All', type: 'All' };
        let calendarDate = new Date('2023-10-01T00:00:00'); // Default to Oct 2023 for Mock Data

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderView();
            updateSidebarCount();
            populateConnectModal();
        });

        // --- Navigation Logic ---
        function switchTab(tabName) {
            activeTab = tabName;
            
            // Update Sidebar UI
            const navAccounts = document.getElementById('nav-accounts');
            const navSchedule = document.getElementById('nav-schedule');
            
            if (tabName === 'accounts') {
                navAccounts.className = "w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors bg-indigo-50 text-indigo-700";
                navSchedule.className = "w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-50 hover:text-gray-900";
                document.getElementById('mobile-title').textContent = 'Accounts';
            } else {
                navAccounts.className = "w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-50 hover:text-gray-900";
                navSchedule.className = "w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors bg-indigo-50 text-indigo-700";
                document.getElementById('mobile-title').textContent = 'Schedule';
            }
            
            renderView();
            // Close mobile sidebar if open
            if(window.innerWidth < 1024) toggleSidebar();
        }

        function switchScheduleTab(tabName) {
            activeScheduleTab = tabName;
            renderView();
        }

        function setScheduleView(view) {
            scheduleView = view;
            renderView();
        }

        function changeMonth(offset) {
            calendarDate.setMonth(calendarDate.getMonth() + offset);
            renderView();
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            const isOpen = !sidebar.classList.contains('-translate-x-full');
            
            if (isOpen) {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
            } else {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
            }
        }

        function updateSidebarCount() {
            const count = posts.filter(p => p.status === 'Scheduled').length;
            document.getElementById('scheduled-count').textContent = count;
        }

        // --- Render Logic ---
        function renderView() {
            const container = document.getElementById('content-area');
            if (activeTab === 'accounts') {
                container.innerHTML = getAccountsPageHTML();
                setupFilterListeners();
            } else {
                container.innerHTML = getSchedulePageHTML();
            }
            lucide.createIcons();
        }

        // --- Accounts Page ---
        function getAccountsPageHTML() {
            // Filter Data
            const availablePlatforms = ['All', ...new Set(accounts.map(acc => acc.platform))];
            
            const filteredAccounts = accounts.filter(acc => {
                const matchesType = filters.type === 'All' || acc.type === filters.type;
                const matchesPlatform = filters.platform === 'All' || acc.platform === filters.platform;
                const matchesStatus = filters.status === 'All' ? true : (filters.status === 'Issues' ? acc.status !== 'connected' : acc.status === filters.status);
                const matchesSearch = acc.name.toLowerCase().includes(filters.search.toLowerCase()) || acc.platform.toLowerCase().includes(filters.search.toLowerCase());
                return matchesType && matchesPlatform && matchesStatus && matchesSearch;
            });

            return `
                <div class="max-w-6xl mx-auto space-y-6">
                    <!-- Header -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-900">Connected Accounts</h1>
                            <p class="text-gray-500 text-sm mt-1">Manage your community presence across platforms.</p>
                        </div>
                        <button onclick="openModal('connect-modal')" class="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-all shadow-sm">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Connect Account
                        </button>
                    </div>

                    <!-- Filters -->
                    <div class="flex flex-col gap-4 bg-white p-3 rounded-xl border border-gray-100 shadow-sm">
                        <div class="flex flex-col md:flex-row gap-3">
                            <div class="relative flex-1">
                                <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"></i>
                                <input id="search-input" type="text" placeholder="Search accounts..." value="${filters.search}" class="w-full pl-9 pr-4 py-2 bg-gray-50 border-transparent focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-lg text-sm transition-all">
                            </div>
                            <div class="flex gap-2">
                                <select id="platform-filter" class="bg-gray-50 border-transparent rounded-lg text-sm py-2 px-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="All">All Platforms</option>
                                    ${availablePlatforms.filter(p => p !== 'All').map(p => `<option value="${p}" ${filters.platform === p ? 'selected' : ''}>${p}</option>`).join('')}
                                </select>
                                <select id="status-filter" class="bg-gray-50 border-transparent rounded-lg text-sm py-2 px-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    <option value="All" ${filters.status === 'All' ? 'selected' : ''}>All Status</option>
                                    <option value="connected" ${filters.status === 'connected' ? 'selected' : ''}>Synced</option>
                                    <option value="Issues" ${filters.status === 'Issues' ? 'selected' : ''}>Issues Only</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex overflow-x-auto pb-1 gap-2 no-scrollbar border-t border-gray-100 pt-3">
                            ${platformTypes.map(type => `
                                <button onclick="setFilterType('${type}')" class="px-3 py-1.5 rounded-lg text-xs font-medium transition-colors whitespace-nowrap ${filters.type === type ? 'bg-indigo-100 text-indigo-700 border border-indigo-200' : 'bg-white text-gray-600 border border-gray-200 hover:bg-gray-50'}">
                                    ${type}
                                </button>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        ${filteredAccounts.map(account => getAccountCardHTML(account)).join('')}
                        
                        <!-- Add New Placeholder -->
                        <button onclick="openModal('connect-modal')" class="flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-200 rounded-xl text-gray-400 hover:text-indigo-600 hover:border-indigo-300 hover:bg-indigo-50/30 transition-all group h-full min-h-[220px]">
                            <div class="p-3 rounded-full bg-gray-50 group-hover:bg-white mb-3 transition-colors">
                                <i data-lucide="plus" class="w-6 h-6"></i>
                            </div>
                            <span class="font-medium">Connect New Account</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function getAccountCardHTML(account) {
            const isConnected = account.status === 'connected';
            const statusBadge = !isConnected 
                ? (account.status === 'warning' 
                    ? `<span class="flex items-center gap-1 text-xs font-medium text-amber-600 bg-amber-50 px-2 py-1 rounded-full border border-amber-100"><i data-lucide="clock" class="w-3 h-3"></i> Expired</span>`
                    : `<span class="flex items-center gap-1 text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full border border-red-100"><i data-lucide="alert-triangle" class="w-3 h-3"></i> Error</span>`)
                : '';
            
            const growthClass = account.growth.startsWith('+') ? 'text-green-600' : 'text-red-500';
            const growthIcon = account.growth.startsWith('+') ? 'trending-up' : 'trending-down';

            return `
                <div class="group bg-white rounded-xl border border-gray-200 p-5 hover:border-indigo-300 hover:shadow-md transition-all duration-200 flex flex-col">
                    <div class="flex justify-between items-start mb-2">
                        <div class="p-2.5 rounded-lg text-white ${account.color}">
                            <i data-lucide="${account.icon}" class="w-5 h-5"></i>
                        </div>
                        <div class="flex gap-1">
                            ${statusBadge}
                            <button class="text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-50 rounded-full">
                                <i data-lucide="more-vertical" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h3 class="font-semibold text-gray-900 leading-tight">${account.name}</h3>
                        <p class="text-sm text-gray-500 font-mono mt-0.5">${account.handle}</p>
                    </div>

                    <div class="flex items-center gap-2 mb-4">
                        <span class="text-xs font-medium px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full">${account.platform}</span>
                        <span class="text-xs text-gray-400">â€¢</span>
                        <span class="text-xs text-gray-500">${account.type}</span>
                    </div>

                    <div class="grid grid-cols-2 gap-2 mb-4 py-3 border-t border-b border-gray-50">
                        <div>
                            <p class="text-xs text-gray-500 mb-0.5">Audience</p>
                            <p class="font-bold text-gray-900">${account.followers}</p>
                        </div>
                        <div>
                            <p class="text-xs text-gray-500 mb-0.5">Growth (30d)</p>
                            <div class="flex items-center text-xs font-bold ${growthClass}">
                                <i data-lucide="${growthIcon}" class="w-3 h-3 mr-1"></i>
                                ${account.growth}
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between mt-auto pt-2">
                        <button onclick="openDetailsModal(${account.id})" class="text-sm font-medium text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 px-3 py-1.5 -ml-3 rounded-lg transition-colors">
                            View Details
                        </button>
                        ${isConnected 
                            ? `<span class="flex items-center text-xs text-green-600 font-medium shrink-0"><div class="w-1.5 h-1.5 rounded-full bg-green-500 mr-1.5"></div>Synced</span>` 
                            : `<button class="flex items-center gap-1.5 text-xs font-medium text-white bg-gray-900 hover:bg-black px-3 py-1.5 rounded-md transition-colors shadow-sm shrink-0"><i data-lucide="refresh-cw" class="w-3 h-3"></i> Reconnect</button>`}
                    </div>
                </div>
            `;
        }

        function setupFilterListeners() {
            document.getElementById('search-input').addEventListener('input', (e) => {
                filters.search = e.target.value;
                renderView();
                const input = document.getElementById('search-input');
                input.focus();
                input.setSelectionRange(input.value.length, input.value.length);
            });
            document.getElementById('platform-filter').addEventListener('change', (e) => {
                filters.platform = e.target.value;
                renderView();
            });
            document.getElementById('status-filter').addEventListener('change', (e) => {
                filters.status = e.target.value;
                renderView();
            });
        }

        function setFilterType(type) {
            filters.type = type;
            renderView();
        }

        // --- Schedule Page (Updated for Tabs, Clusters, and Calendar) ---
        function getSchedulePageHTML() {
            return `
                <div class="max-w-6xl mx-auto space-y-6">
                    <!-- Header & Controls -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-900">Scheduled Posts</h1>
                            <p class="text-gray-500 text-sm mt-1">Overview of your upcoming content timeline.</p>
                        </div>
                        <div class="flex gap-2 w-full sm:w-auto">
                            <!-- View Toggle -->
                            <div class="bg-gray-100 p-1 rounded-lg flex gap-1">
                                <button onclick="setScheduleView('list')" class="p-1.5 rounded-md transition-all ${scheduleView === 'list' ? 'bg-white shadow text-indigo-600' : 'text-gray-500 hover:text-gray-700'}">
                                    <i data-lucide="list" class="w-4 h-4"></i>
                                </button>
                                <button onclick="setScheduleView('calendar')" class="p-1.5 rounded-md transition-all ${scheduleView === 'calendar' ? 'bg-white shadow text-indigo-600' : 'text-gray-500 hover:text-gray-700'}">
                                    <i data-lucide="calendar" class="w-4 h-4"></i>
                                </button>
                            </div>

                            <button class="flex-1 sm:flex-none flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-all shadow-sm">
                                <i data-lucide="plus" class="w-4 h-4"></i> Create Post
                            </button>
                        </div>
                    </div>

                    ${scheduleView === 'list' ? getListViewHTML() : getCalendarViewHTML()}
                </div>
            `;
        }

        function getListViewHTML() {
             // 1. Filter posts based on active tab
            let displayPosts = [];
            const now = new Date('2023-10-25T00:00:00'); // Simulated 'Current Time' for demo logic
            
            if (activeScheduleTab === 'Queue') {
                displayPosts = posts.filter(p => p.status === 'Scheduled' || (p.status === 'Published' && new Date(p.date) > now));
            } else if (activeScheduleTab === 'Drafts') {
                displayPosts = posts.filter(p => p.status === 'Draft');
            } else if (activeScheduleTab === 'History') {
                displayPosts = posts.filter(p => p.status === 'Published' && new Date(p.date) <= now);
            }

            // 2. Sort by date
            displayPosts.sort((a, b) => new Date(a.date) - new Date(b.date));

            // 3. Group by Cluster
            const groupedItems = [];
            const processedIds = new Set();

            displayPosts.forEach(post => {
                if (processedIds.has(post.id)) return;

                if (post.clusterId) {
                    const clusterPosts = displayPosts.filter(p => p.clusterId === post.clusterId);
                    groupedItems.push({ type: 'cluster', items: clusterPosts, topic: post.topic, date: post.date });
                    clusterPosts.forEach(p => processedIds.add(p.id));
                } else {
                    groupedItems.push({ type: 'single', ...post });
                    processedIds.add(post.id);
                }
            });

            const hasItems = groupedItems.length > 0;
            const tabs = ['Queue', 'Drafts', 'History'];

            return `
                 <!-- Tab Navigation -->
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                        ${tabs.map(tab => `
                            <button 
                                onclick="switchScheduleTab('${tab}')"
                                class="${activeScheduleTab === tab 
                                    ? 'border-indigo-500 text-indigo-600' 
                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} 
                                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors"
                            >
                                ${tab}
                                ${tab === 'Queue' ? `<span class="ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs">${posts.filter(p=>p.status==='Scheduled').length}</span>` : ''}
                            </button>
                        `).join('')}
                    </nav>
                </div>

                <!-- Content List -->
                <div class="space-y-4">
                    ${!hasItems 
                        ? getEmptyStateHTML(activeScheduleTab)
                        : groupedItems.map(item => item.type === 'cluster' ? getClusterHTML(item) : getPostItemHTML(item)).join('')
                    }
                </div>
            `;
        }

        function getCalendarViewHTML() {
            const year = calendarDate.getFullYear();
            const month = calendarDate.getMonth();
            const monthName = calendarDate.toLocaleString('default', { month: 'long' });
            
            const firstDay = new Date(year, month, 1).getDay(); // 0 = Sun
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Header for Days
            const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const headerHTML = weekDays.map(day => `<div class="text-center text-xs font-semibold text-gray-500 py-2">${day}</div>`).join('');

            let daysHTML = '';
            for (let i = 0; i < firstDay; i++) {
                daysHTML += `<div class="min-h-[100px] border-b border-r bg-gray-50/30"></div>`;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const currentDateStr = new Date(year, month, day).toDateString();
                const isToday = new Date().toDateString() === currentDateStr; 
                
                const daysPosts = posts.filter(p => {
                    const pDate = new Date(p.date);
                    return pDate.getFullYear() === year && pDate.getMonth() === month && pDate.getDate() === day;
                });

                let postsHTML = daysPosts.map(post => {
                    const account = accounts.find(a => a.id === post.platformId);
                    const bgColor = post.status === 'Published' ? 'bg-green-100 text-green-700' : (post.status === 'Draft' ? 'bg-gray-100 text-gray-600' : 'bg-blue-100 text-blue-700');
                    return `
                        <div onclick="openPostDetailsModal(${post.id})" class="mb-1 text-[10px] p-1 rounded ${bgColor} truncate cursor-pointer hover:opacity-80 flex items-center gap-1 transition-opacity">
                            <i data-lucide="${account ? account.icon : 'circle'}" class="w-2.5 h-2.5 shrink-0"></i>
                            ${post.title}
                        </div>
                    `;
                }).join('');

                daysHTML += `
                    <div class="min-h-[100px] border-b border-r p-2 bg-white hover:bg-gray-50 transition-colors">
                        <div class="text-sm font-medium ${isToday ? 'text-indigo-600 bg-indigo-50 w-6 h-6 rounded-full flex items-center justify-center' : 'text-gray-700'} mb-2">${day}</div>
                        <div class="space-y-1">
                            ${postsHTML}
                        </div>
                    </div>
                `;
            }

            return `
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                    <div class="flex items-center justify-between p-4 border-b border-gray-200">
                        <h2 class="text-lg font-bold text-gray-900">${monthName} ${year}</h2>
                        <div class="flex items-center gap-2">
                            <button onclick="changeMonth(-1)" class="p-1 hover:bg-gray-100 rounded-lg text-gray-600">
                                <i data-lucide="chevron-left" class="w-5 h-5"></i>
                            </button>
                            <button onclick="changeMonth(1)" class="p-1 hover:bg-gray-100 rounded-lg text-gray-600">
                                <i data-lucide="chevron-right" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="calendar-grid border-l border-t border-gray-200">
                        ${headerHTML}
                        ${daysHTML}
                    </div>
                </div>
            `;
        }

        function getEmptyStateHTML(tabName) {
            return `
                <div class="p-12 text-center text-gray-500 bg-white rounded-xl border border-gray-200">
                    <i data-lucide="${tabName === 'Drafts' ? 'file-edit' : 'calendar-days'}" class="w-12 h-12 mx-auto mb-4 text-gray-300"></i>
                    <h3 class="text-lg font-medium text-gray-900">No ${tabName.toLowerCase()} found</h3>
                    <p class="mt-1">Your content queue is currently empty.</p>
                </div>
            `;
        }

        function getClusterHTML(cluster) {
            const dateObj = new Date(cluster.date);
            const isToday = dateObj.toDateString() === new Date('2023-10-25').toDateString(); 
            const dayStr = dateObj.toLocaleDateString('en-US', { weekday: 'short' });
            const dateStr = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            const timeStr = dateObj.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

            const accountIcons = cluster.items.map(post => {
                const account = accounts.find(a => a.id === post.platformId);
                return `
                    <div class="w-6 h-6 rounded-full text-white ${account.color} flex items-center justify-center border border-white ring-1 ring-gray-100 relative group/icon">
                        <i data-lucide="${account.icon}" class="w-3.5 h-3.5"></i>
                    </div>
                `;
            }).join('<div class="w-1"></div>'); 

            return `
                <div class="bg-white rounded-xl border border-indigo-200 shadow-sm p-4 sm:p-5 hover:bg-gray-50 transition-colors flex flex-col sm:flex-row gap-4 sm:items-center relative overflow-hidden group">
                    <div class="absolute left-0 top-0 bottom-0 w-1 bg-indigo-500"></div>

                    <div class="flex sm:flex-col items-center sm:items-start gap-2 sm:gap-0 sm:w-24 shrink-0 pl-2">
                         <span class="text-xs font-bold uppercase tracking-wider ${isToday ? 'text-indigo-600' : 'text-gray-500'}">
                            ${isToday ? 'Today' : dayStr}
                        </span>
                        <span class="text-sm font-semibold text-gray-900">${dateStr}</span>
                        <span class="text-xs text-gray-400 hidden sm:block">${timeStr}</span>
                    </div>

                    <div class="flex-1 min-w-0">
                        <h4 class="text-base font-bold text-gray-900 truncate pr-4 flex items-center gap-2">
                            ${cluster.topic}
                            <span class="px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 text-[10px] uppercase tracking-wider font-bold">Cluster</span>
                        </h4>
                        <p class="text-sm text-gray-500 truncate mt-0.5 mb-2">${cluster.items[0].content}</p>

                        <div class="flex items-center mt-2">
                             <span class="text-xs text-gray-400 mr-2">Publishing to:</span>
                             <div class="flex items-center -space-x-1 hover:space-x-0 transition-all duration-200">
                                ${accountIcons}
                             </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between sm:justify-end w-full sm:w-auto gap-4 mt-2 sm:mt-0">
                        <span class="flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border bg-blue-100 text-blue-700 border-blue-200">
                            <i data-lucide="clock" class="w-3 h-3 mr-1"></i> Scheduled (${cluster.items.length})
                        </span>

                        <div class="flex gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity">
                            <button class="p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="Post All Now"><i data-lucide="zap" class="w-4 h-4"></i></button>
                            <button onclick="openClusterDetailsModal(${cluster.items[0].clusterId})" class="p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="View Cluster"><i data-lucide="eye" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                </div>
            `;
        }

        function getPostItemHTML(post) {
            const account = accounts.find(a => a.id === post.platformId);
            const dateObj = new Date(post.date);
            const isToday = dateObj.toDateString() === new Date('2023-10-25').toDateString(); 
            const dayStr = dateObj.toLocaleDateString('en-US', { weekday: 'short' });
            const dateStr = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            const timeStr = dateObj.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            let statusStyles = 'bg-gray-100 text-gray-700 border-gray-200';
            let statusIcon = 'file-text';
            let stripColor = 'bg-gray-400';
            
            if(post.status === 'Published') { 
                statusStyles = 'bg-green-100 text-green-700 border-green-200'; 
                statusIcon = 'check-circle-2'; 
                stripColor = 'bg-green-500';
            }
            if(post.status === 'Scheduled') { 
                statusStyles = 'bg-blue-100 text-blue-700 border-blue-200'; 
                statusIcon = 'clock'; 
                stripColor = 'bg-blue-500';
            }

            let actionsHTML = '';
            if (post.status === 'Draft') {
                 actionsHTML = `
                    <button class="p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="Approve & Schedule"><i data-lucide="check-circle" class="w-4 h-4"></i></button>
                    <button onclick="openPostDetailsModal(${post.id})" class="p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="View Details"><i data-lucide="eye" class="w-4 h-4"></i></button>
                 `;
            } else {
                 actionsHTML = `
                    <button class="p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="Post Now"><i data-lucide="zap" class="w-4 h-4"></i></button>
                    <button class="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="Duplicate"><i data-lucide="copy" class="w-4 h-4"></i></button>
                    <button onclick="openPostDetailsModal(${post.id})" class="p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="View Details"><i data-lucide="eye" class="w-4 h-4"></i></button>
                 `;
            }

            const accountIcon = `
                <div class="w-6 h-6 rounded-full text-white ${account ? account.color : 'bg-gray-400'} flex items-center justify-center border border-white ring-1 ring-gray-100 relative group/icon" title="${account ? account.name : 'Unknown'}">
                    <i data-lucide="${account ? account.icon : 'help-circle'}" class="w-3.5 h-3.5"></i>
                </div>
                <span class="text-xs text-gray-600 ml-2 font-medium">${account ? account.name : 'Unknown'}</span>
            `;

            return `
                <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-4 sm:p-5 hover:bg-gray-50 transition-colors flex flex-col sm:flex-row gap-4 sm:items-center relative overflow-hidden group">
                    <div class="absolute left-0 top-0 bottom-0 w-1 ${stripColor}"></div>

                    <div class="flex sm:flex-col items-center sm:items-start gap-2 sm:gap-0 sm:w-24 shrink-0 pl-2">
                        <span class="text-xs font-bold uppercase tracking-wider ${isToday ? 'text-indigo-600' : 'text-gray-500'}">
                            ${isToday ? 'Today' : dayStr}
                        </span>
                        <span class="text-sm font-semibold text-gray-900">${dateStr}</span>
                        <span class="text-xs text-gray-400 hidden sm:block">${timeStr}</span>
                    </div>
                    
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2 mb-1">
                            <h4 class="text-base font-bold text-gray-900 truncate">${post.title}</h4>
                            <span class="px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 text-[10px] uppercase tracking-wider font-bold">${post.type}</span>
                        </div>
                        <p class="text-sm text-gray-500 truncate mt-0.5 mb-2">${post.content}</p>
                        
                        <div class="flex items-center mt-2">
                             <span class="text-xs text-gray-400 mr-2">Publishing to:</span>
                             <div class="flex items-center">
                                ${accountIcon}
                             </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between sm:justify-end w-full sm:w-auto gap-4 mt-2 sm:mt-0">
                        <span class="flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${statusStyles}">
                            <i data-lucide="${statusIcon}" class="w-3 h-3 mr-1"></i> ${post.status}
                        </span>
                        
                        <div class="flex gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity">
                            ${actionsHTML}
                            <button class="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors tooltip-trigger relative" data-tooltip="Delete"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- Modals ---
        function populateConnectModal() {
            const grid = document.getElementById('platform-grid');
            const platforms = ['Twitter', 'LinkedIn', 'Facebook', 'Instagram', 'WordPress', 'Substack', 'Reddit', 'Discord'];
            grid.innerHTML = platforms.map(p => `
                <button class="flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 text-left text-sm font-medium text-gray-700 transition-colors">
                    <div class="w-2 h-2 rounded-full bg-gray-400"></div> ${p}
                </button>
            `).join('');
        }

        function openModal(id) {
            const modal = document.getElementById(id);
            modal.classList.remove('hidden-modal');
            modal.classList.add('visible-modal');
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            modal.classList.remove('visible-modal');
            modal.classList.add('hidden-modal');
        }

        function openDetailsModal(accountId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) return;

            const content = document.getElementById('details-content');
            const isConnected = account.status === 'connected';
            const growthClass = account.growth.startsWith('+') ? 'text-green-600' : 'text-red-500';
            const growthIcon = account.growth.startsWith('+') ? 'trending-up' : 'trending-down';

            content.innerHTML = `
                <div class="divide-y divide-gray-100">
                    <!-- Header -->
                    <div class="p-6">
                        <div class="flex items-center gap-4 mb-6">
                            <div class="p-4 rounded-xl text-white ${account.color} shadow-sm shrink-0">
                                <i data-lucide="${account.icon}" class="w-8 h-8"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-900">${account.name}</h3>
                                <div class="flex flex-wrap items-center gap-2 mt-1">
                                    <span class="font-mono text-sm text-gray-600">${account.handle}</span>
                                    <a href="#" class="text-indigo-600 hover:text-indigo-800 p-1 rounded hover:bg-indigo-50"><i data-lucide="external-link" class="w-3.5 h-3.5"></i></a>
                                    <span class="text-gray-300">â€¢</span>
                                    <span class="text-sm px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full font-medium">${account.type}</span>
                                </div>
                            </div>
                        </div>

                        <div class="p-3 rounded-lg border ${isConnected ? 'bg-green-50 border-green-100' : 'bg-red-50 border-red-100'}">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="${isConnected ? 'check-circle-2' : 'alert-triangle'}" class="w-5 h-5 ${isConnected ? 'text-green-600' : 'text-red-600'}"></i>
                                    <span class="font-medium text-sm ${isConnected ? 'text-green-900' : 'text-red-900'}">
                                        ${isConnected ? 'Data sync active' : 'Token expired - reconnection required'}
                                    </span>
                                </div>
                                ${!isConnected ? `<button class="px-3 py-1 bg-white border border-red-200 text-red-700 text-xs font-bold uppercase tracking-wide rounded shadow-sm hover:bg-red-50">Reconnect</button>` : ''}
                            </div>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="p-6 bg-gray-50/50">
                        <div class="flex items-center gap-2 mb-4">
                            <i data-lucide="bar-chart-3" class="w-4 h-4 text-gray-500"></i>
                            <h4 class="font-semibold text-gray-900">Performance Overview</h4>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="p-4 bg-white rounded-xl border border-gray-100 shadow-sm">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Total Audience</p>
                                <p class="text-2xl font-bold text-gray-900">${account.followers}</p>
                            </div>
                            <div class="p-4 bg-white rounded-xl border border-gray-100 shadow-sm">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Growth (30d)</p>
                                <div class="flex items-center text-xl font-bold ${growthClass}">
                                    <i data-lucide="${growthIcon}" class="w-5 h-5 mr-2"></i> ${account.growth}
                                </div>
                            </div>
                            <div class="p-4 bg-white rounded-xl border border-gray-100 shadow-sm">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Avg. Likes</p>
                                <p class="text-lg font-bold text-gray-900">${account.avgLikes}</p>
                            </div>
                            <div class="p-4 bg-white rounded-xl border border-gray-100 shadow-sm">
                                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">Avg. Comments</p>
                                <p class="text-lg font-bold text-gray-900">${account.avgComments}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Logs -->
                    <div class="p-6">
                        <div class="flex items-center gap-2 mb-4">
                            <i data-lucide="activity" class="w-4 h-4 text-gray-500"></i>
                            <h4 class="font-semibold text-gray-900">Recent System Activity</h4>
                        </div>
                        <div class="space-y-3">
                            <div class="flex gap-3 text-sm">
                                <div class="w-2 h-2 mt-1.5 rounded-full bg-green-500 shrink-0"></div>
                                <div><p class="text-gray-900 font-medium">Synced analytics data</p><p class="text-xs text-gray-500">Today at 10:42 AM</p></div>
                            </div>
                            <div class="flex gap-3 text-sm">
                                <div class="w-2 h-2 mt-1.5 rounded-full bg-blue-500 shrink-0"></div>
                                <div><p class="text-gray-900 font-medium">Post published successfully</p><p class="text-xs text-gray-500">Yesterday at 2:00 PM</p></div>
                            </div>
                        </div>
                    </div>

                    <!-- API Guide -->
                    <div class="p-6 bg-gray-50 border-t border-gray-100">
                        <div class="flex items-center gap-2 mb-3">
                            <i data-lucide="code" class="w-4 h-4 text-gray-500"></i>
                            <h4 class="font-semibold text-gray-900">Developer API Guide</h4>
                        </div>
                        <a href="${account.apiGuide}" target="_blank" rel="noopener noreferrer" class="flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg hover:border-indigo-300 hover:shadow-sm transition-all group">
                            <div class="flex items-center gap-3">
                                <div class="p-2 bg-indigo-50 text-indigo-600 rounded-lg"><i data-lucide="book-open" class="w-4 h-4"></i></div>
                                <div>
                                    <p class="text-sm font-medium text-gray-900">${account.platform} API Documentation</p>
                                    <p class="text-xs text-gray-500">View official integration guides</p>
                                </div>
                            </div>
                            <i data-lucide="external-link" class="w-4 h-4 text-gray-400 group-hover:text-indigo-600"></i>
                        </a>
                    </div>

                    <!-- Footer -->
                    <div class="p-4 bg-gray-50 flex justify-between items-center border-t border-gray-200">
                        <button class="flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 px-2 py-1 rounded hover:bg-gray-100 transition-colors">
                            <i data-lucide="settings" class="w-4 h-4"></i> Configure Settings
                        </button>
                        <button onclick="closeModal('details-modal')" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors shadow-sm">Done</button>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
            openModal('details-modal');
        }

        function openPostDetailsModal(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;
            
            const account = accounts.find(a => a.id === post.platformId);
            const contentDiv = document.getElementById('post-details-content');
            const modalTitle = document.getElementById('post-modal-title');
            
            modalTitle.innerText = "Post Details";
            const dateObj = new Date(post.date);
            const dateStr = dateObj.toLocaleString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute:'2-digit' });

            contentDiv.innerHTML = `
                <div>
                    <h4 class="text-lg font-bold text-gray-900 mb-1">${post.title}</h4>
                    <p class="text-sm text-gray-500">${dateStr} â€¢ ${post.status}</p>
                </div>
                
                <div class="bg-gray-50 border border-gray-200 rounded-xl p-4">
                    <p class="text-gray-800 whitespace-pre-line text-sm leading-relaxed">${post.content}</p>
                </div>

                <div class="flex items-center gap-4 bg-white border border-gray-100 p-3 rounded-lg shadow-sm">
                    <div class="w-10 h-10 rounded-full text-white ${account.color} flex items-center justify-center">
                        <i data-lucide="${account.icon}" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <p class="font-medium text-sm text-gray-900">${account.name}</p>
                        <p class="text-xs text-gray-500">${account.platform} â€¢ ${post.type}</p>
                    </div>
                </div>
            `;
            
            openModal('post-details-modal');
            lucide.createIcons();
        }

        function openClusterDetailsModal(clusterId) {
            const clusterPosts = posts.filter(p => p.clusterId === clusterId);
            if (clusterPosts.length === 0) return;
            
            const contentDiv = document.getElementById('post-details-content');
            const modalTitle = document.getElementById('post-modal-title');
            modalTitle.innerText = "Cluster Details";
            
            const topic = clusterPosts[0].topic;
            const dateObj = new Date(clusterPosts[0].date);
            const dateStr = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });

            const postsHTML = clusterPosts.map(post => {
                const account = accounts.find(a => a.id === post.platformId);
                return `
                    <div class="border-b border-gray-100 last:border-0 pb-4 last:pb-0 pt-4 first:pt-0">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-6 h-6 rounded-full text-white ${account.color} flex items-center justify-center text-[10px]">
                                <i data-lucide="${account.icon}" class="w-3 h-3"></i>
                            </div>
                            <span class="text-sm font-medium text-gray-900">${account.name}</span>
                            <span class="text-xs text-gray-400">â€¢ ${post.type}</span>
                        </div>
                        <p class="text-sm text-gray-600 pl-8">${post.content}</p>
                    </div>
                `;
            }).join('');

            contentDiv.innerHTML = `
                <div>
                    <h4 class="text-lg font-bold text-gray-900 mb-1 flex items-center gap-2">
                        ${topic}
                        <span class="px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 text-[10px] uppercase tracking-wider font-bold">Cluster</span>
                    </h4>
                    <p class="text-sm text-gray-500">Scheduled for ${dateStr} â€¢ ${clusterPosts.length} Posts</p>
                </div>
                
                <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
                    ${postsHTML}
                </div>
            `;
            
            openModal('post-details-modal');
            lucide.createIcons();
        }
    </script>
</body>
</html>
